!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);class o{constructor(){this._listeners={}}addEventListener(e,t){this._listeners[e].push(t)}removeEventListener(e,t){let n=this._listeners[e].findIndex(e=>e.listener===t);n>=0&&this._listeners.splice(n,1)}removeEventListeners(){this._listeners={}}emit(e,t){this._listeners[e].forEach(e=>{t?e(t):e()})}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}}class s extends o{constructor(){super()}initialize(){let e=indexedDB.open("attendance_db",1);e.onerror=e=>{console.log(e.errorCode)},e.onsuccess=e=>{this.db=e.target.result,this.emit("ready"),this.db.transaction("employees").objectStore("employees").count().onsuccess=e=>{0==e.target.result&&this.emit("empty")}},e.onupgradeneeded=e=>{this.db=e.target.result;let t=this.db.createObjectStore("employees",{autoIncrement:!0});t.createIndex("name","name",{unique:!0}),t.createIndex("department",["department","rankInt","name"],{unique:!1})}}getEmployees(){this.db.transaction("employees").objectStore("employees").index("department").openCursor().onsuccess=e=>{let t=e.target.result;if(t){let e=t.value,n=t.primaryKey;this.emit("employee-added",{key:n,employee:e}),t.continue()}}}updateEmployee(e,t){this.db.transaction("employees","readwrite").objectStore("employees").put(t,e)}addEmployees(e){let t=this.db.transaction("employees","readwrite"),n=t.objectStore("employees");t.onerror=e=>{console.log(e)};for(let t of e)n.add(t).onsuccess=e=>{let n=e.target.result;this.emit("employee-added",{key:n,employee:t})}}deleteEmployee(e){this.db.transaction("employees","readwrite").objectStore("employees").delete(e)}}const i={LG:1,MG:2,BG:3,COL:4,SLTC:5,LTC:6,MAJ:7,CPT:8,LTA:9,"2LT":10,DX:30,CWO:31,SWO:32,MWO:33,"1WO":34,"2WO":35,"3WO":36,MSG:37,SSG:38,"1SG":39,"2SG":40,"3SG":41,CFC:42,CPL:43,LCP:44,PTE:45,REC:46};var r={fromString(e){try{let t=e.split(","),n=t.length-1,o="TRUE"==t[n].trim().toUpperCase();o&&n--;let s=1,r="";for(;s<n;)s>1&&(r+=", "),r+=t[s].trim().toLowerCase(),s++;let a=t[0].trim().toUpperCase(),l=(e=>{if(e.toUpperCase().includes("DX")){return 30-Number(e.substring(2))}return i[e]})(a);if(void 0===l)throw Error;return{rank:a,rankInt:l,name:r,department:t[n].trim().toLowerCase(),status:0,isRegular:o,remark:""}}catch(e){return null}},toList(e){let t=e.trim().split(/\r?\n/),n=[];for(let e of t){let t=this.fromString(e);t&&n.push(t)}return n}};let a;class l extends o{constructor(){super(),this.list={},this.db=new s,this.db.on("employee-added",this.employeeAdded.bind(this)),this.db.on("ready",()=>{this.db.getEmployees()}),this.db.on("empty",()=>{this.emit("empty")})}static getInstance(){return a||(a=new l),a}start(){this.db.initialize()}isHigher(e,t){return e.rankInt<t.rankInt}employeeAdded(e){let{key:t,employee:n}=e,o=n.department;this.list[o]||(this.list[o]=[]);let s=this.list[o].length;for(;s>0;){let e=this.list[o][s-1].employee;if(!this.isHigher(n,e))break;s--}this.list[o].splice(s,0,{key:t,employee:n}),this.emit("employee-added",{key:t,employee:n,index:s})}getItemIndex(e,t){return this.list[e].findIndex(e=>e.key==t)}removeEmployee(e,t){this.db.deleteEmployee(t);let n=this.getItemIndex(e,t);this.list[e].splice(n,1),0==this.list[e].length&&(this.emit("department-removed",e),delete this.list[e],0===Object.keys(this.list).length&&this.emit("empty"))}updateEmployeeStatus(e,t,n){let o=this.getItemIndex(e,t),s=this.list[e][o].employee;s.status=n,this.db.updateEmployee(t,s)}updateEmployeeRemark(e,t,n){let o=this.getItemIndex(e,t),s=this.list[e][o].employee;s.remark=n,this.db.updateEmployee(t,s)}addEmployees(e){let t=r.toList(e);this.db.addEmployees(t)}}const d="PointerEvent"in window;var h={onclick:function(e,t){d?e.onpointerup=t:e.onclick=t},animate:function(e,t,n){const o=t=>{e.removeEventListener("animationend",o),n()};e.addEventListener("animationend",o),e.classList.add(t)}};let p=!1,c=null,m=0;class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n  <style>\n    .container {\n      position: relative;\n      width: 200px;\n    }\n    .menu {\n      position: absolute;\n      border-bottom-right-radius: 2px;\n      top: 0;\n      left: 0;\n      z-index: 5; \n      color: black;\n      width: inherit;\n      height: var(--min-height);\n      overflow: hidden;\n      box-shadow: 0;\n      pointer-events: auto;\n      transition: height .5s, box-shadow .5s .3s;\n      background: white;\n    }\n    \n    .appear {\n      transition: height .5s, box-shadow .5s;\n      height: var(--max-height);\n      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);\n    }\n   \n    p {\n      margin: 0;\n      padding: 10px 15px;\n      font-size: 1rem;\n      cursor: pointer;\n      touch-action: none;\n      transition: .2s background;\n    }\n\n    p.active {\n      background: #909090;\n    }\n\n    .appear > #list {\n      top: 0;\n    }\n\n    #list {\n      width: inherit;\n      position: absolute;\n      top: var(--item-offset);\n      left: 0;\n      transition: all .5s;\n    }\n\n\n\n  </style>\n  \n  <div class="container">\n    <p id="title">Empty</p>\n    <div class="menu">\n      <div id="list">\n      \n      </div>\n    </div>\n  \n  </div>\n',this.menu=this.shadowRoot.querySelector(".menu"),this.list=this.shadowRoot.getElementById("list"),this.options=[];let e=this.shadowRoot.getElementById("title");this.itemWidth=e.offsetHeight,this.menu.style.setProperty("--min-height",`${this.itemWidth}px`)}add(e){m++,this.menu.style.setProperty("--max-height",`${m*this.itemWidth}px`);let t=document.createElement("p");t.textContent=e,h.onclick(t,t=>{this.onSelected(e)}),this.list.appendChild(t),this.options.push(e)}remove(e){let t=this.options.findIndex(t=>t==e);this.options.splice(t,1),m--,this.list.children[t].remove(),this.menu.style.setProperty("--max-height",`${m*this.itemWidth}px`),c=null,this.setCurrentItem(this.options[0]);let n=new CustomEvent("onChange",{detail:{next:0}});this.dispatchEvent(n)}onSelected(e){if(1!=m)if(p){p=!1,this.setCurrentItem(e),this.menu.classList.remove("appear");this.options.findIndex(t=>t==e);let t=new CustomEvent("onChange",{detail:{next:e}});this.dispatchEvent(t)}else{if(m<1)return;p=!0,this.menu.classList.add("appear")}}setCurrentItem(e){if(null!=c){let e=this.options.findIndex(e=>e==c);this.list.children[e].classList.remove("selected")}let t=this.options.findIndex(t=>t==e);this.list.children[t].classList.add("selected"),this.list.style.setProperty("--item-offset",`-${t*this.itemWidth}px`),c=e}}class y extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n    <style>\n      .container {\n        display: grid;\n        grid-auto-flow: column;\n        grid-auto-columns: 100vw;\n        height: 100%;\n        touch-action: none;\n        width: auto;\n        transform: translateX(0px);\n        overflow-x: hidden;\n        }\n      .disable-scrollbars::-webkit-scrollbar {\n        width: 0px;\n        background: transparent; /* Chrome/Safari/Webkit */\n      }\n        \n      .disable-scrollbars {\n        scrollbar-width: none; /* Firefox */\n            -ms-overflow-style: none;  /* IE 10+ */\n      }\n     \n    </style>\n\n    <div class="container disable-scrollbars">\n    </div>\n',this.container=this.shadowRoot.querySelector(".container");this.container;this.numberOfPages=0,this.currentIndex=0,this.pageWidth=window.innerWidth}getPage(e){return this.container.querySelector(e)}add(e){this.container.appendChild(e),this.numberOfPages++,this.container.style.width=`${this.pageWidth*this.numberOfPages}px`}setCurrentItem(e){this.currentIndex=e;let t=e*this.pageWidth;this.container.style.transform=`translateX(-${t}px`}}var g=[{name:"NOT SET",fullName:"NOT SET",category:"NOT SET"},{name:"PRESENT",fullName:"PRESENT",category:"PRESENT"},{name:"RSO",fullName:"RSO",category:"RSO/RSI"},{name:"RSI",fullName:"RSI",category:"RSO/RSI"},{name:"MC",fullName:"MC",category:"MC/MA"},{name:"MA",fullName:"MA",category:"MC/MA"},{name:"OIL",fullName:"OFF IN LIEU",category:"OIL/LEAVE"},{name:"AL",fullName:"ANNUAL LEAVE",category:"OIL/LEAVE"},{name:"UL",fullName:"URGENT LEAVE",category:"OIL/LEAVE"},{name:"OL",fullName:"OVERSEAS LEAVE",category:"OIL/LEAVE"},{name:"CL",fullName:"COMPASSIONATE LEAVE",category:"OIL/LEAVE"},{name:"PL",fullName:"PATERNITY LEAVE",category:"OIL/LEAVE"},{name:"PCL",fullName:"PARENT CARE LEAVE",category:"OIL/LEAVE"},{name:"CCL",fullName:"CHILD CARE LEAVE",category:"OIL/LEAVE"},{name:"AO",fullName:"ATTACHED OUT",category:"AO/OA"},{name:"OA",fullName:"OVERSEAS ATTACHMENT",category:"AO/OA"},{name:"OOC",fullName:"OUT OF CAMP",category:"OOC/OTHERS"},{name:"OTHERS",fullName:"OTHERS",category:"OOC/OTHERS"}];class b extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n  <style>\n    .page {\n     \n    }\n    p {\n      margin: 0;\n    }\n    .item {\n      padding: 10px 15px;\n      transition: .3s background;\n      cursor: pointer;\n    }\n    \n    .item:active {\n      background: #F0F0F0;\n    }\n    \n    .item:last-child {\n      border-bottom-left-radius: 15px;\n      border-bottom-right-radius: 15px;\n    }\n    \n    #name {\n      text-transform: capitalize;\n      color: #323232;\n      font-weight: 700;\n    }\n    \n    #status {\n      color: #878787;\n      font-size: 0.8rem;\n      font-weight: 600;\n    }\n    \n    #header {\n      color: #828282;\n      text-transform: capitalize;\n    }\n    \n    #card {\n      border-radius: 15px;\n      background: white;\n      box-shadow: 0px 2px 50px 0px rgba(209,202,209,1);\n    }\n    \n    #strength {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      padding: 10px;\n      font-weight: 900;\n      background: #34495e;\n      border-top-left-radius: 15px;\n      border-top-right-radius: 15px;\n      color:white;\n    }\n  </style>\n  \n  <div class="page">\n    <h3 id="header"></h3>\n    <div id="card">\n      <div id="strength">0 Present</div>\n      <div id="list"></div>\n    </div>\n  </div>\n  \n  <template id="item">\n    <div class="item">\n      <p id="name"></p>\n      <p id="status"></p>\n    </div>\n  </template>\n',this.header=this.shadowRoot.getElementById("header"),this.list=this.shadowRoot.getElementById("list"),this.strengthInfo=this.shadowRoot.getElementById("strength"),this.employees={},this.presentNsf=0,this.presentReg=0,this.present={}}setPresenter(e){this.presenter=e}setDepartment(e){this.department=e,this.header.textContent=e}addEmployee(e,t,n){this.employees[e]=t;let o=this.createItem(e,t,n),s=this.list.children[n];this.list.insertBefore(o,s)}createItem(e,t,n){let o=t.rank+" "+t.name,s="";t.remark.length>0&&(s=` (${t.remark})`);let i=this.shadowRoot.getElementById("item").content.cloneNode(!0),r=i.querySelector(".item"),a=i.getElementById("name"),l=i.getElementById("status");return r.setAttribute("key",e),a.textContent=o,l.textContent=g[t.status].name+s,h.onclick(r,t=>{this.openDetails(e,this.employees[e])}),this.checkPresent(e),i}getListItem(e){return this.list.querySelector(`.item[key='${e}']`)}onRemarkChanged(e,t){let n=this.getListItem(e),o=this.employees[e];o.remark=t;let s="";t&&t.length>0&&(s=` (${t})`),n.querySelector("#status").textContent=g[o.status].name+s,this.presenter.updateEmployeeRemark(this.department,e,t)}onStatusChanged(e,t){let n=this.getListItem(e);this.employees[e].status=t,n.querySelector("#status").textContent=g[t].name,this.presenter.updateEmployeeStatus(this.department,e,t),this.checkPresent(e)}onDeleteEmployee(e){delete this.employees[e],this.getListItem(e).remove(),this.presenter.removeEmployee(this.department,e)}onSaveEmployee(e,t){this.onDeleteEmployee(e),this.presenter.saveEmployeeInfo(t)}checkPresent(e){let t=this.employees[e],n=t.isRegular;if(1==t.status){if(this.present[e])return;this.present[e]=!0,n?this.presentReg++:this.presentNsf++}else{if(!this.present[e])return;this.present[e]=!1,n?this.presentReg--:this.presentNsf--}let o=`${this.presentNsf+this.presentReg} Present ~ ${this.presentReg} Reg + ${this.presentNsf} Nsf`;this.strengthInfo.textContent=o}openDetails(e,t){let n=document.createElement("employee-dialogue");n.setEmployee(e,t,this),document.body.appendChild(n)}}class f extends HTMLElement{constructor(e){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=(e=>`\n    <style>\n        #root {\n            position: absolute;\n            top: 0;\n            left: 0;\n            display: grid;\n            grid-template-columns: 1fr;\n            grid-template-areas: "content";\n            justify-items: center;\n            align-items: center;\n            height: 100vh;\n            opacity: 1;\n            z-index: 99;\n        }\n\n        @keyframes fade-in {\n            0% { opacity: 0; }\n            100% { opacity: 1; }\n        }\n    \n        @keyframes fade-out {\n            0% { opacity: 1; }\n            100% { opacity: 0; }\n        }\n    \n        @keyframes slide-in {\n            0% { transform: translateY(100px); }\n            100% { transform: translateY(0px); }\n        }\n        \n        @keyframes slide-out {\n            100% { transform: translateY(100px); }\n        }\n\n        div#root.show{\n            animation: fade-in .2s;\n        }\n\n        div#root.hide  {\n            animation: fade-out .2s forwards;\n        }\n\n        .show > #dialogue {\n            animation: slide-in .2s;\n        }\n        \n        .hide > #dialogue {\n            animation: slide-out .2s forwards;\n        }\n        \n        #scrim {\n            background: rgba(0,0,0,.2);\n            grid-area: content;\n            height: 100vh;\n            width: 100vw;\n        }\n\n        #dialogue {\n            grid-area: content;\n            background: white;\n            border-radius: 5px;\n            box-shadow: 0px 4px 4px rgba(0,0,0,.25);\n            padding: 15px 25px;\n            transform: translateY(0px);\n            width: calc(100% - 50px);\n            box-sizing: border-box;\n            margin: 0 30px;\n        }\n        \n        #dialogue.shake {\n            animation: shake 0.82s cubic-bezier(.36, .07, .19, .97) both;\n        }\n        \n        @keyframes shake {\n           10%, 90% {\n              transform: translateX(-1px);\n            }\n        \n           20%, 80% {\n              transform: translateX(2px);\n            }\n        \n            30%, 50%, 70% {\n              transform: translateX(-4px);\n            }\n        \n            40%, 60% {\n              transform: translateX(4px);\n            }\n          }\n    </style>\n\n    <div id="root">\n  \n        <div id="scrim"></div>\n    \n        <div id="dialogue">\n            ${e}\n        </div>\n        \n    </div>\n`)(e),this.root=this.shadowRoot.getElementById("root");let t=this.shadowRoot.getElementById("scrim"),n=this.shadowRoot.getElementById("dialogue");this.isCancellable=!0,h.animate(this.root,"show",()=>{this.root.classList.remove("show"),t.onclick=e=>{this.isCancellable?this.close():h.animate(n,"shake",()=>{n.classList.remove("shake")})}})}close(){h.animate(this.root,"hide",()=>{this.remove()})}}class x extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n  <style>\n    :host {\n      --button-color: var(--color-primary);\n      --button-color-dark: var(--color-primary-dark);\n      --button-color-rgb: var(--color-primary-rgb);\n      --button-radius: 5px;\n    }\n    \n    :host([type="solid"]) > button {\n      background: var(--button-color);\n      color: white;\n      border: 2px solid var(--button-color);\n      border-radius: 2px;\n    }\n    \n    :host([type="outline"]) > button {\n      background: white;\n      color: var(--button-color);\n      border: 2px solid;\n      border-radius: 2px;\n      border-color: var(--button-color);\n    }\n    \n    :host([type="outline"]) button:active {\n      background: rgba(0,0,0,.2);\n    }\n    \n    :host([type="plain"]) > button {\n      background: white;\n      color: var(--button-color);\n      border-radius: 15px;\n    }\n    \n    :host([type="plain"]) > button:active {\n      background: rgba(0,0,0,.1);\n    }\n    \n    :host([type="glow"]) > button {\n      box-shadow: 0 4px 6px -1px rgba(var(--button-color-rgb), 0.2), 0 2px 4px -1px rgba(var(--button-color-rgb), 0.12);\n    }\n    \n    button {\n      font: inherit;\n      font-size: var(--button-font-size);\n      padding: var(--button-padding);\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      cursor: pointer;\n      outline: none;\n      border: none;\n      border-radius: var(--button-radius);\n      color: white;\n      background: var(--button-color);\n      width: 100%;\n      transition: all .2s;\n    }\n    \n    button:active {\n      background: var(--button-color-dark);\n    }\n  </style>\n  \n  <button><slot></slot></button>\n';let e=this.shadowRoot.querySelector("button");h.onclick(e,e=>{this.dispatchEvent(new Event("onclick"))})}set onclick(e){this.addEventListener("onclick",t=>e(t))}}class w{constructor(){this.employeeRepository=l.getInstance()}getSummary(){let e={},t=this.employeeRepository.list;for(let[n,o]of Object.entries(t))for(let{key:t,employee:n}of o){let t=n.status,o=g[t].category;e[o]||(e[o]={}),e[o][t]||(e[o][t]=[]),n.remark&&n.remark.length>0?e[o][t].unshift(n):e[o][t].push(n)}return e}async downloadToExcel(){let e=this.employeeRepository.list,t=[],n={};const o=e=>e.rank+" "+e.name;for(let[n,o]of Object.entries(e))for(let{key:e,employee:n}of o)t.push(n);t.sort((e,t)=>e.rankInt<t.rankInt?-1:t.rankInt<e.rankInt?1:e.name<t.name?-1:t.name<e.name?1:0);for(let e of t){let t=e.status;0==t&&(t=17),n[t]||(n[t]=[]),n[t].push(e)}let s=0,i=[];if(n[1]){for(let e of n[1])i.push(["",++s,o(e)]);i[0][0]="*Present*"}let r=s+"/"+t.length,a=new Date,l=a.getMonth()+1,d=String(a.getDate()).padStart(2,"0")+"/"+l+"/"+a.getFullYear(),h=[["SBW PLC Strength","","",""],[],["Date",d],["Total Strength",r],[]];delete n[1];let p=0;for(let[e,t]of Object.entries(n)){i.push([]);let n=i.length;for(let n of t){let t=o(n);t.length>p&&(p=t.length);let r=["",++s,t];17==e&&r.push(n.remark),i.push(r)}i[n][0]=`*${g[e].fullName}*`}let c=await XlsxPopulate.fromBlankAsync();c.sheet(0).name("Attendance sheet"),c.sheet(0).column("A").style({bold:!0,italic:!0}),c.sheet(0).column("A").width(21),c.sheet(0).column("B").width(10),c.sheet(0).column("C").width(p+5),c.sheet(0).cell("A1").value(h.concat(i));let m=await c.outputAsync();return{name:`SBW PARADE STATE ${d}.xlsx`,url:window.URL.createObjectURL(m)}}}class E extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n  <style>\n    \n    \n    #header {\n      color: #828282;\n      text-transform: capitalize;\n    }\n        \n    #card {\n      border-radius: 15px;\n      background: white;\n      box-shadow: 0px 2px 50px 0px rgba(209, 202, 209, 1);\n    }\n    \n    #strength {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      padding: 10px;\n      font-weight: 900;\n      background: #34495e;\n      border-top-left-radius: 15px;\n      border-top-right-radius: 15px;\n      color:white;\n    }\n  </style>\n  \n  <div>\n    <h3 id="header"></h3>\n    <div id="card">\n      <div id="strength">0 Present</div> \n      <div id="list"></div> \n    </div>\n  </div>\n',this.header=this.shadowRoot.getElementById("header"),this.strength=this.shadowRoot.getElementById("strength"),this.list=this.shadowRoot.getElementById("list"),this.strength=this.shadowRoot.getElementById("strength")}addStyle(e){let t=document.createElement("style");t.innerHTML=e,this.shadowRoot.appendChild(t)}setHeader(e){this.header.textContent=e}setStrength(e,t){let n=`${e+t} Present ~ ${e} Reg + ${t} Nsf`;this.strength.textContent=n}setTotal(e,t){let n=`${e+t} Total ~ ${e} Reg + ${t} Nsf`;this.strength.textContent=n}addItem(e){this.list.appendChild(e)}}customElements.define("section-view",E);class v extends HTMLElement{constructor(){super(),this.summaryPresenter=new w,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='\n    <style>\n        .container {\n            background: white;\n            height: 100%;\n            width: 100%;\n            position: fixed;\n            top: 0;\n            left: 0;\n            z-index: 9;\n            transition: .5s transform;\n            transform: translateY(100%);\n            background: #FAF5FA;\n            scrollbar-width: none;\n        }\n\n        .container.show {\n            transform: translateY(0%);\n        }\n\n        #toolbar {\n            position: fixed;\n            top: 0;\n            left: 0;\n            right: 0;\n            margin: 0;\n            display: flex;\n            justify-content: space-between;\n            flex-direction: row;\n            padding: 12px 10px;\n            background: rgba(250, 245, 250, 0.9);\n            transition: .5s all;\n        }\n        \n        #toolbar > p {\n          padding: 0;\n          margin: 0;\n          font-weight: 900;\n        }\n        \n        #toolbar > h4 {\n          padding: 0;\n          margin: 0px 10px 0px 0px;\n        }\n        \n        wc-button {\n          position: fixed;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          --button-radius: 0;\n          --button-padding: 15px 10px;\n          --button-font-size: 1.3rem;\n          --color-primary: #2ecc71;\n          --color-primary-dark: #27ae60;\n          box-shadow: 0px 2px 3px 2px rgba(0,0,0,0.2);\n        }\n        \n        #list { \n        height: 100%;\n        overflow-y: scroll;\n        padding-left: 20px;\n        padding-right: 20px;\n        padding-bottom: 80px;\n        box-sizing: border-box;\n        padding-top: 40px;\n        scrollbar-width: none;\n        }  \n        \n        #list::-webkit-scrollbar {\n            display: none;\n        }\n        \n        .loading {\n          position: absolute;\n          background: white;\n          height: 100%;\n          width: 100%;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n        \n        @keyframes fade-out {\n          to {opacity: 0;}\n        }\n        \n        .fade-out {\n          animation: fade-out 1s;\n        }\n       \n\n    </style>\n    \n    <div class="container">\n        <div id="toolbar">\n          <p>Total strength</p>\n           <h4>X</h4>\n         </div>\n        <div id="list"></div>\n        <wc-button>Export to excel</wc-button>\n        \n         <div class="loading">\n            <h4>Loading</h4>\n         </div>\n    </div>\n';let e=this.shadowRoot.getElementById("toolbar");this.titleText=e.querySelector("p"),h.onclick(e,e=>{this.close()}),this.shadowRoot.querySelector("wc-button").onclick=e=>{this.downloadFile()},this.list=this.shadowRoot.getElementById("list"),this.list.onscroll=t=>{this.list.scrollTop>0?e.style.boxShadow="3px 0px 3px 3px rgba(50,50,50,0.3)":e.style.boxShadow="0px 0px 0px 0px rgba(0,0,0,0)"}}close(){this.shadowRoot.querySelector(".container").classList.remove("show"),window.URL.revokeObjectURL(this.fileUrl)}show(){let e=this.shadowRoot.querySelector(".loading");e.style.display="flex",this.shadowRoot.querySelector(".container").classList.add("show"),this.list.innerHTML="";let t=this.summaryPresenter.getSummary(),n=0;for(let[e,o]of Object.entries(t)){n+=this.createCategory(e,o)}this.titleText.textContent=`Total strength: ${n}`,this.summaryPresenter.downloadToExcel().then(t=>{this.fileUrl=t.url,this.fileName=t.name,h.animate(e,"fade-out",()=>{e.style.display="none",e.classList.remove("fade-out")})})}downloadFile(){var e=document.createElement("a");e.href=this.fileUrl,e.download=this.fileName,document.body.appendChild(e),e.click(),e.remove()}createCategory(e,t){let n=0,o=0,s=document.createElement("section-view");s.setHeader(e),s.addStyle("\n        .sub-header {\n          margin-top: 10px;\n          text-align: center;\n          font-weight: 900;\n          color: red;\n        }\n        .item {\n         font-weight: 600;\n         padding: 5px 15px;\n         font-size: 0.9rem;\n         text-transform: capitalize;\n        }\n        .item:last-child {\n          padding-top: 5px;\n          padding-bottom: 15px;\n        }\n        \n        .bold {\n          font-weight: 700;\n          color: #EAB543;\n        }\n      ");for(let[e,i]of Object.entries(t)){let t=g[e].name,r=document.createElement("div");r.classList.add("sub-header"),r.textContent=t,s.addItem(r);for(let e of i){let t=document.createElement("div");t.classList.add("item"),e.remark.length>0&&t.classList.add("bold");let i=e.rank+" "+e.name;e.remark&&e.remark.length>0&&(i+=" - "+e.remark),t.textContent=i,s.addItem(t),e.isRegular?n++:o++}}return s.setTotal(n,o),this.list.appendChild(s),n+o}}customElements.define("wc-button",x),customElements.define("department-fragment",b),customElements.define("view-pager",y),customElements.define("dropdown-menu",u),customElements.define("edit-dialogue",class extends f{constructor(){super('\n    <style>\n        .container {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n        }\n        textarea {\n            min-height: 100px;\n        }\n       \n        wc-button {\n            margin-top: 20px;\n            --button-font-size: 1rem;     \n            --button-padding: 10px;\n        }\n        \n        p {\n          margin: 10px 0;\n        }\n\n        textarea {\n            font: inherit;\n            margin: 15px 0;\n            outline: none;\n            border: 3px solid;\n            border-color: #b9b9b9;\n            border-radius: 3px;\n            padding: 5px;\n            font-size: 0.8rem;\n            transition: border-color .2s;\n        }\n\n        textarea:focus {\n            animation: glow 1.5s infinite;\n        }\n            \n        @keyframes glow {\n            0% { border-color: #b9b9b9; }\n            50% { border-color: #ED4C67; }\n            100% { border-color: #b9b9b9; }\n        }\n    </style>\n\n    \n    <div class="container">\n        <p>Add new personnels</p>\n\n        <textarea placeholder="RANK, NAME, DEPARTMENT\n\nCPL, Bob Jr, KKK Branch\nMAJ, James Bond, ZZZ Branch\nLCP, John Doe, XXX Branch\nPTE, William Baker, AAA Branch\n"></textarea>\n\n        <wc-button id="save">Save</wc-button>  \n    </div>\n'),this.employeeRepository=l.getInstance();const e=this.shadowRoot.getElementById("save"),t=this.shadowRoot.querySelector("textarea");e.onclick=e=>{let n;0!=t.value.length&&(n=t.value,this.employeeRepository.addEmployees(n))},this.employeeRepository.on("employee-added",e=>{this.close()})}setCancellable(e){this.isCancellable=e}}),customElements.define("employee-dialogue",class extends f{constructor(){super('\n  <style>\n    .container {\n      position: relative;\n    }\n    .status {\n      display: flex;\n      flex-wrap: wrap;\n      width: 90%;\n      --button-padding: 5px;\n    }\n    .status > wc-button {\n      margin-right: 10px;\n      margin-bottom: 10px;\n    }\n    .remark > p {\n      margin: 5px 0;\n    }\n    input {\n      padding: 5px;\n      border: 1px solid grey;\n      transition: all .3s .3s;\n      outline:none;\n      font: inherit;\n    }\n    input:focus {\n      outline: none;\n      border: 1px solid #FF3838;\n    }\n    .header {\n      display: flex;\n      align-items: center;\n    }\n\n    .header > h4 {\n      flex-grow: 1;\n    }\n\n    .header > wc-button {\n      --button-padding: 3px 8px;\n    }\n\n    #edit-screen {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      top: 0;\n      background: white;\n      display: none;\n      flex-direction: column;\n      justify-content: space-evenly;\n    }\n\n    #edit-screen > input {\n      width: 100%;\n    }\n\n    #edit-screen > .submit {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .submit > wc-button {\n      --button-padding: 5px 8px;\n      margin: 15px 10px;\n    }\n  </style>\n  \n  <div class="container">\n    <div id="main-screen">\n      <div class="header">\n        <h4></h4>\n        <wc-button type="plain" id="edit">edit</wc-button>\n      </div>\n      \n      <div class="status">\n        \n      </div>\n      \n      <div class="remark">\n        <p>Remarks</p>\n        <input id="status-input" type="text" placeholder="Event, work, pooping etc.">\n      </div>\n    </div>\n\n    <div id="edit-screen">\n      <input id="save-input" type="text" placeholder="Rank, Name, Department, isRegular(true)"}>\n\n      <div class="submit">\n        <wc-button id="save">Save</wc-button>\n        <wc-button id="delete" type="plain">Delete</wc-button>\n      </div>\n\n    </div>\n  </div>\n  \n');let e=this.shadowRoot.getElementById("edit-screen"),t=this.shadowRoot.getElementById("edit"),n=this.shadowRoot.getElementById("save"),o=this.shadowRoot.getElementById("delete");this.remark=this.shadowRoot.getElementById("status-input"),this.saveInput=this.shadowRoot.getElementById("save-input"),t.onclick=t=>{e.style.display="flex"},n.onclick=e=>{this.callback.onSaveEmployee(this.key,this.saveInput.value),super.close()},o.onclick=e=>{this.callback.onDeleteEmployee(this.key),super.close()}}close(){let e=this.remark.value.trim();this.callback.onRemarkChanged(this.key,e),super.close()}setStatus(e){let t,n=this.shadowRoot.querySelector(".status");this.statusIndex=e;for(let e in g){let o=document.createElement("wc-button");o.textContent=g[e].name,e==this.statusIndex?(o.setAttribute("type","solid"),t=o):o.setAttribute("type","outline"),n.appendChild(o),o.onclick=n=>{t!=o&&(this.statusIndex=e,o.setAttribute("type","solid"),t&&t.setAttribute("type","outline"),t=o,this.callback.onStatusChanged(this.key,this.statusIndex))}}}setEmployee(e,t,n){this.callback=n,this.key=e,this.employee=t,this.remark.value=t.remark,this.shadowRoot.querySelector("h4").textContent=t.rank+" "+t.name,this.setStatus(t.status),this.saveInput.value=t.rank+", "+t.name+", "+t.department}}),customElements.define("summary-view",v);const k=document.getElementById("add"),R=document.querySelector(".fragment-holder");R.onscroll=e=>{R.scrollTop>0?k.style.right="-50px":k.style.right="20px"},k.onclick=e=>{let t=document.createElement("edit-dialogue");t.isCancellable=!0,document.body.appendChild(t)},document.getElementById("summary").onclick=e=>{document.querySelector("summary-view").show()};const I=l.getInstance();I.on("empty",e=>{let t=document.createElement("edit-dialogue");t.setCancellable(!1),document.body.appendChild(t)});new class{constructor(){this.employeeRepository=l.getInstance(),this.fragments={},this.fragmentHolder=document.querySelector(".fragment-holder"),this.employeeRepository.on("employee-added",this.addEmployee.bind(this))}removeDepartment(e){let t=e.detail;this.fragments[t].remove(),delete this.fragments[t]}addEmployee(e){let{key:t,employee:n,index:o}=e,s=n.department;if(!this.fragments[s]){let e=document.createElement("department-fragment");e.setPresenter(this),e.setDepartment(s),this.fragments[s]=e,this.fragmentHolder.appendChild(e)}this.fragments[s].addEmployee(t,n,o)}removeEmployee(e,t){this.employeeRepository.removeEmployee(e,t)}updateEmployeeStatus(e,t,n){this.employeeRepository.updateEmployeeStatus(e,t,n)}updateEmployeeRemark(e,t,n){this.employeeRepository.updateEmployeeRemark(e,t,n)}saveEmployeeInfo(e){this.employeeRepository.addEmployees(e)}};I.start()}]);